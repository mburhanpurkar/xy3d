#!/usr/bin/env python

import matplotlib.pyplot as plt
import numpy as np
import math

# spins = np.array([[2.92421, 4.97336, 0.620021, 2.46623, 2.80199, 1.64261, 5.67817, 6.14943, 5.35035, 5.38513, 5.62191, 4.03582, 1.94962, 4.99299, 1.59567, 5.22002, 0.0928519, 1.67422, 1.85748, 1.87825, 0.822516, 6.22436, 0.289369, 2.68474, 1.44202],
# [3.55266, 2.59182, 1.27301, 1.93246, 3.35213, 0.917643, 0.587351, 6.09959, 5.31247, 3.60149, 4.75842, 6.14258, 4.46324, 0.0102686, 0.0876863, 5.38779, 5.25708, 2.41384, 1.87787, 2.42549, 1.00013, 0.474736, 0.227213, 1.50434, 4.40855],
# [3.13739, 4.33841, 4.47525, 1.80117, 0.854041, 5.90176, 0.571215, 1.95693, 5.41083, 4.66521, 5.99804, 4.41093, 3.57706, 3.6058, 3.29298, 2.53964, 3.4351, 2.63474, 1.06514, 1.72833, 0.662227, 1.43872, 1.71794, 4.19766, 5.53823],
# [5.3566, 5.13619, 1.46947, 2.88239, 2.07638, 1.75476, 1.42675, 0.582392, 5.73358, 5.31099, 5.50899, 3.36253, 5.19903, 4.23572, 4.0089, 2.80118, 0.981505, 2.43283, 3.87166, 6.23905, 1.34034, 5.5879, 0.42343, 5.37092, 5.506],
# [2.62497, 1.33809, 1.52664, 5.33914, 3.69795, 1.96928, 0.280485, 6.25636, 4.44034, 0.157148, 5.31606, 4.51023, 5.03907, 4.72561, 1.5929, 1.88827, 6.1756, 6.07759, 0.548137, 3.22997, 2.87962, 2.14086, 5.55805, 0.602118, 3.40381],
# [1.13295, 2.12899, 2.1277, 2.5586, 5.75879, 4.83886, 5.33923, 4.40642, 3.28004, 6.08108, 5.59908, 0.215424, 5.10596, 6.24205, 5.6752, 4.58805, 5.69529, 1.90732, 1.78343, 3.23624, 2.5128, 6.26613, 4.60211, 1.98325, 2.57442],
# [5.69321, 1.24006, 2.879, 5.9348, 5.75158, 5.08925, 3.91858, 4.24222, 3.37767, 2.96802, 5.47436, 5.36892, 4.4793, 4.42149, 4.27965, 6.21067, 6.13674, 5.52367, 0.440228, 5.58979, 0.433507, 6.00561, 4.51294, 3.90876, 1.89278],
# [6.25933, 5.31976, 4.5775, 0.0315029, 0.415748, 6.21411, 5.2283, 6.00363, 0.838511, 5.79614, 2.14259, 2.67471, 4.37429, 4.48225, 4.32414, 3.41731, 1.55092, 5.09683, 0.659273, 1.86026, 5.5336, 4.56328, 4.14593, 2.85161, 2.20058],
# [0.980879, 5.48738, 5.97831, 6.27913, 0.0822232, 0.98203, 3.86368, 2.96046, 2.66237, 2.07196, 1.26731, 3.26251, 4.26833, 4.7908, 2.93499, 4.02394, 3.36021, 1.51752, 2.24383, 1.60368, 4.67867, 4.02309, 2.6689, 3.39662, 3.83377],
# [1.30111, 2.52872, 5.45323, 2.0381, 2.24604, 3.09544, 0.823765, 3.82842, 5.91083, 4.96027, 4.8242, 6.08872, 1.32468, 2.04255, 3.1683, 1.83109, 3.00504, 1.79145, 4.18352, 3.33674, 2.757, 1.14748, 1.74696, 4.442, 1.25397],
# [5.04116, 1.97869, 2.25619, 4.38725, 4.32327, 6.21978, 6.01071, 4.54388, 3.36979, 4.59212, 2.28451, 5.97876, 1.891, 3.90791, 5.18033, 4.26101, 0.171278, 0.763262, 1.82847, 1.60821, 5.53885, 0.783263, 1.73719, 2.88853, 3.82451],
# [3.13034, 3.28132, 2.58245, 4.93524, 1.62633, 4.66987, 4.01977, 3.80338, 4.56943, 0.296864, 4.80744, 5.76004, 5.68688, 5.15653, 5.38668, 0.545301, 6.22644, 5.03376, 3.80315, 1.30415, 4.96307, 5.65221, 5.69764, 2.35252, 0.869004],
# [5.67272, 2.6848, 2.58966, 1.68175, 0.526015, 2.52466, 2.48441, 4.06758, 4.6109, 5.02737, 3.68913, 0.640224, 5.12282, 5.27882, 3.16298, 3.18855, 2.8393, 3.50653, 4.69942, 3.09043, 0.213579, 5.85022, 3.14347, 1.75017, 5.62523],
# [2.5974, 5.22208, 4.02247, 0.173468, 1.96938, 1.41414, 0.850739, 6.04612, 2.68119, 3.72326, 0.352267, 0.527977, 4.96427, 5.77254, 3.58409, 3.37444, 0.512821, 3.28924, 4.85205, 4.51767, 3.5586, 2.94985, 5.11456, 2.26758, 0.885829],
# [1.24259, 0.889023, 5.81009, 3.15112, 3.16573, 2.45246, 1.1952, 0.509953, 3.37435, 5.84443, 0.881205, 6.12397, 4.22326, 1.55101, 2.2889, 4.95069, 5.75444, 6.12023, 1.3735, 2.17918, 2.31922, 2.95175, 3.43682, 1.55909, 0.641789],
# [5.28309, 4.07606, 3.38391, 2.85077, 2.49391, 3.29247, 1.67242, 2.45499, 2.35337, 2.64699, 4.211, 0.415794, 2.16542, 3.46983, 2.96562, 3.02352, 2.96836, 3.39493, 2.87416, 3.96456, 3.26677, 2.35632, 2.57656, 3.25229, 1.57256],
# [6.12632, 5.42479, 5.9829, 3.75377, 3.90044, 1.88382, 2.51779, 2.28119, 5.46911, 2.40916, 3.81203, 1.02991, 0.173001, 2.94748, 2.63508, 3.32643, 3.83324, 2.58566, 0.420457, 5.17845, 4.19796, 3.42282, 3.73241, 3.57086, 5.89639],
# [5.53909, 1.27172, 0.875484, 3.45528, 4.52668, 1.67502, 2.75926, 3.22424, 4.32121, 3.31781, 1.84468, 1.09427, 5.69904, 6.06436, 0.189785, 1.93333, 1.25342, 3.36139, 4.93388, 5.93887, 5.82026, 1.14702, 4.16113, 2.85164, 0.588043],
# [0.855951, 1.22903, 3.80954, 4.16115, 2.05753, 4.92623, 4.78908, 1.94157, 3.73464, 3.39736, 0.92693, 5.33054, 5.61506, 5.49248, 6.14441, 1.61131, 2.60806, 0.495198, 6.21272, 1.52527, 5.76879, 1.06485, 5.65029, 4.18736, 0.410317],
# [3.95177, 4.59995, 2.62911, 3.46229, 4.57717, 6.19682, 5.62393, 0.982775, 4.07201, 4.76596, 1.84839, 3.25406, 3.3468, 0.318817, 0.639704, 5.18774, 1.48996, 3.09541, 4.44264, 2.25273, 2.93364, 5.68071, 1.38897, 3.92623, 1.40247],
# [4.8554, 5.10156, 2.29179, 3.06049, 2.20413, 0.80674, 1.54852, 1.50623, 2.87123, 1.22379, 1.59953, 0.637458, 5.62792, 3.93648, 0.351084, 0.183779, 2.76748, 5.22448, 2.13628, 2.09942, 3.89421, 5.40438, 2.39108, 3.02645, 0.451415],
# [5.11287, 2.86825, 2.78433, 0.436777, 5.5731, 5.50305, 0.381433, 3.49316, 2.81399, 2.5176, 3.22012, 1.10534, 0.369821, 6.16566, 4.32471, 5.14092, 5.14559, 5.44611, 1.99649, 1.2318, 4.05194, 4.8357, 0.302116, 3.36655, 4.49933],
# [3.29058, 3.0787, 4.24192, 1.60373, 1.74764, 4.96279, 3.5594, 5.57711, 4.33427, 5.53139, 3.99275, 2.72861, 4.81919, 4.41614, 1.76284, 1.78415, 5.36529, 5.33097, 5.19897, 3.26694, 4.2065, 3.72621, 4.14238, 4.46576, 6.19821],
# [6.06364, 4.12857, 4.14591, 2.82156, 4.45741, 4.30835, 4.19854, 1.54307, 5.66383, 0.227373, 1.60464, 1.22055, 4.60938, 4.74668, 0.345029, 6.25905, 5.30371, 5.38236, 2.28075, 2.0314, 0.988979, 4.1123, 4.1544, 2.97293, 2.62589],
#                   [3.12297, 2.67342, 3.33206, 2.94039, 2.8963, 1.27953, 3.47437, 2.02772, 0.355669, 2.94677, 3.75389, 2.28451, 2.63554, 5.65295, 5.90418, 6.13251, 5.75361, 3.86916, 2.15834, 0.463702, 0.791061, 6.20152, 5.76723, 2.1016, 0.744985]])

# print spins[6, 20], spins[5, 20], spins[5, 19], spins[6, 19]
# print math.pi / 4.0, 3 * math.pi / 4.0, 5 * math.pi / 4.0, 7 * math.pi / 4.0


spins = np.array([[1.53543, 1.48859, 1.81585, 2.00549, 1.41656, 2.75842, 1.42607, 0.697791, 1.91311, 0.289257, 2.66956, 2.34316, 3.20977, 2.56246, 3.61259, 1.35471, 1.21018, 2.54636, 0.715358, 1.68675, 1.42868, 1.96427, 2.68797, 2.57635, 1.84549],
[5.10361, 0.24365, 5.08899, 6.09621, 4.18298, 1.58053, 5.7792, 4.23846, 1.70296, 5.00459, 3.12435, 4.30152, 4.06518, 4.55559, 4.87332, 1.21503, 4.71304, 4.4971, 5.60181, 4.11655, 6.18974, 4.46213, 0.182968, 4.7597, 1.06514],
[6.21607, 1.07022, 6.10124, 1.52474, 0.0207914, 0.218273, 1.94175, 2.05064, 1.27731, 2.47987, 2.83676, 5.80627, 1.5602, 2.92483, 3.6219, 1.83875, 1.58687, 1.33584, 0.853027, 1.83618, 1.29519, 1.75607, 0.188191, 2.76078, 1.68505],
[5.49919, 5.70456, 0.101729, 1.04901, 5.76304, 2.01203, 0.861385, 0.467631, 1.86171, 5.70636, 0.26942, 5.00283, 0.696692, 3.53065, 4.46387, 5.98997, 3.7811, 1.35806, 6.09262, 1.40143, 0.490102, 0.651986, 6.10015, 3.7284, 0.759581],
[5.36087, 1.97416, 1.44509, 1.70591, 3.16966, 2.07656, 2.06441, 5.98807, 0.951487, 4.55842, 1.34703, 3.03423, 1.53799, 2.64169, 1.54646, 1.914, 3.59059, 2.49535, 3.20288, 1.6667, 2.34306, 2.31566, 1.11994, 3.38428, 1.40752],
[2.60742, 2.28978, 1.92231, 1.3941, 4.42333, 5.08843, 2.19444, 3.06206, 2.8235, 4.07726, 1.48516, 3.34014, 2.09606, 2.78469, 1.99099, 1.85807, 2.7986, 2.22652, 2.02485, 2.20471, 1.61737, 3.16878, 2.32763, 2.06365, 1.34971],
[3.86369, 1.53798, 1.89147, 2.06475, 4.63497, 2.56774, 2.52625, 1.47879, 0.911315, 0.306721, 1.62316, 0.14197, 1.00848, 1.33447, 2.5993, 0.600919, 1.86574, 3.07251, 1.7778, 1.40884, 1.55398, 2.46355, 2.40113, 0.914126, 1.53567],
[2.70546, 2.13234, 1.79313, 1.97173, 2.56475, 1.09375, 1.75317, 1.32018, 1.42274, 4.02305, 2.15262, 2.86424, 1.5271, 3.17499, 2.49208, 0.310926, 2.03667, 0.852959, 1.21581, 1.77864, 0.890066, 2.92144, 1.38972, 0.0430666, 2.37457],
[4.26569, 2.554, 5.37301, 2.14723, 6.11731, 3.59762, 2.2966, 0.143847, 0.477556, 4.31445, 2.04495, 5.67408, 4.07525, 4.04564, 2.27831, 1.93905, 2.63405, 1.38272, 5.21789, 1.65816, 0.41907, 3.49445, 5.27391, 3.59428, 0.04966],
[5.18715, 2.9034, 1.70277, 1.56175, 5.76291, 4.49177, 3.09543, 1.26677, 1.70166, 4.81415, 2.23638, 4.66827, 1.20358, 3.24012, 2.95686, 1.72311, 2.89159, 2.10234, 1.94439, 3.27064, 0.342808, 2.23649, 0.62043, 1.83412, 1.73611],
[4.17615, 1.20296, 4.75608, 3.66711, 4.43108, 3.8955, 3.09525, 0.273622, 2.29668, 4.11009, 2.08634, 4.72066, 3.38377, 2.93283, 3.56065, 4.69664, 0.561107, 3.38574, 1.08059, 0.351078, 5.26418, 4.15471, 3.27819, 4.88035, 5.8711],
[4.5743, 1.62549, 0.605524, 0.48399, 5.91331, 2.53087, 0.106087, 1.91618, 1.23944, 4.84677, 2.79166, 3.48584, 0.580717, 3.75419, 3.20438, 3.10727, 2.58525, 3.17556, 1.36652, 1.63948, 5.9003, 2.3788, 2.28217, 3.01186, 2.49476],
[4.0262, 1.12995, 5.99052, 3.31527, 2.84375, 4.38235, 2.2637, 4.61904, 2.56272, 3.42293, 4.67415, 4.64937, 4.90516, 4.01488, 2.70329, 2.99203, 4.46166, 0.857976, 5.5001, 4.31726, 1.92149, 3.57435, 4.45877, 3.29407, 3.45049],
[5.17929, 1.65234, 5.4957, 2.49073, 5.54374, 3.27263, 1.84189, 5.55079, 3.02814, 4.38056, 1.84739, 2.93127, 3.65014, 2.73253, 4.03341, 1.03159, 3.16994, 3.06462, 2.52032, 3.74744, 2.25761, 3.43776, 4.84712, 3.37607, 2.42477],
[2.71872, 1.22065, 0.333392, 1.8018, 2.17232, 2.63135, 1.74641, 1.07771, 1.70227, 4.02684, 3.89897, 2.57459, 0.130437, 3.07655, 2.72866, 1.74677, 4.11903, 3.11171, 1.16018, 1.19881, 1.96991, 2.18485, 1.47551, 3.38602, 1.2482],
[4.65566, 2.0206, 4.9687, 3.3955, 4.73238, 1.76676, 2.76882, 5.92033, 2.5368, 4.01374, 3.56619, 3.52077, 4.53668, 3.97429, 3.47393, 2.87769, 3.62356, 3.01333, 3.59451, 3.06271, 3.19859, 2.84294, 1.25213, 2.92409, 5.29819],
[2.99687, 1.32278, 1.68432, 0.950513, 1.76473, 1.12294, 2.84192, 1.34274, 2.18635, 2.34491, 2.16268, 1.24537, 1.05352, 2.337, 2.82094, 1.69676, 3.85486, 2.26767, 0.705665, 2.44307, 1.15946, 2.99507, 1.09117, 2.49053, 1.65827],
[5.35365, 1.36986, 0.145869, 1.91631, 5.35914, 5.33119, 2.29775, 0.21295, 0.549899, 5.11416, 2.4256, 5.26196, 1.08496, 3.54018, 3.28747, 1.58588, 2.69687, 3.77541, 1.03196, 0.833315, 1.7342, 1.82445, 0.250208, 2.71577, 5.77343],
[1.51727, 1.00338, 5.34744, 0.384437, 6.24277, 1.6403, 1.85355, 1.60584, 1.28415, 3.4106, 3.10039, 6.04508, 2.77822, 3.24932, 3.00815, 1.82629, 2.48244, 1.5658, 1.95479, 1.77814, 0.900991, 1.90335, 0.26672, 2.53233, 1.05955],
[0.429473, 1.45174, 0.99395, 1.19693, 6.19693, 0.810685, 1.0681, 1.43593, 2.21509, 1.70886, 1.84793, 0.0638152, 0.518531, 2.34785, 1.93035, 0.696326, 2.17648, 1.79959, 1.09935, 0.739157, 1.09676, 2.33467, 0.437182, 4.67834, 0.342178],
[2.95363, 1.61442, 0.469732, 2.17565, 5.53153, 2.83133, 2.21202, 2.66517, 1.9168, 2.31121, 2.30835, 3.53625, 4.46944, 2.48497, 3.32855, 1.75017, 2.52216, 1.27144, 1.47169, 2.06824, 1.71146, 2.02332, 1.78821, 1.18939, 1.33203],
[4.07364, 1.51762, 1.02377, 1.06549, 1.0184, 2.04392, 1.42692, 0.909428, 0.0244645, 4.88763, 1.93357, 5.52986, 3.28242, 2.42233, 1.4639, 1.54718, 1.00078, 1.93297, 0.381143, 2.4937, 1.07811, 2.62107, 1.62749, 1.20945, 0.987239],
[4.45481, 2.01928, 1.7815, 2.2705, 2.30704, 2.28565, 1.36891, 1.70331, 1.03395, 2.85579, 3.57684, 1.63545, 3.18947, 2.20187, 2.61272, 1.60863, 3.01089, 2.97958, 1.53036, 2.01343, 3.52926, 2.56668, 2.78501, 2.69994, 1.94089],
[0.436292, 0.215704, 6.22729, 5.1949, 0.935779, 1.32608, 0.396217, 6.12999, 5.89281, 3.91426, 1.26075, 4.25487, 0.994991, 4.60236, 3.63759, 1.0626, 1.14185, 0.834136, 1.60873, 0.150174, 1.17359, 2.42203, 6.23613, 0.0493019, 0.100436],
[3.66635, 3.01966, 4.36547, 2.52288, 2.86638, 1.93156, 1.30478, 3.0458, 3.76822, 5.18027, 3.62356, 4.25172, 1.8299, 2.1326, 2.87325, 1.29768, 2.65266, 3.26595, 1.60244, 3.52139, 0.917314, 4.15593, 2.28537, 2.4751, 2.21105]])


# np.array([[3.29118, 2.76034, 4.44995, 3.91526, 3.55361, 5.36252, 3.35057, 1.8774, 5.26218, 4.39576, 5.18816, 1.40201, 5.12914, 0.0237603, 5.17677, 5.29696],
# [1.19882, 3.86755, 2.8311, 2.81167, 3.19455, 2.1262, 3.55621, 3.09323, 2.41337, 4.17332, 4.28228, 2.80678, 4.33443, 5.7596, 3.95854, 3.44375],
# [1.11354, 4.39079, 2.95743, 4.41213, 4.16073, 3.56342, 3.57083, 0.16573, 0.240679, 5.72879, 2.23254, 3.31686, 3.11551, 3.61964, 4.32079, 5.02591],
# [1.29325, 0.462655, 4.85169, 4.65467, 5.15729, 3.94652, 3.27107, 1.72256, 1.45517, 2.651, 2.44299, 3.19092, 4.17418, 4.09515, 0.717731, 0.536195],
# [5.90471, 1.61383, 2.78328, 5.19726, 4.55061, 3.14818, 4.73918, 6.27601, 0.41226, 1.15269, 5.25058, 5.0492, 4.57273, 5.19037, 5.36433, 4.66826],
# [6.21981, 6.09177, 2.39249, 5.71093, 5.60203, 3.50132, 6.18846, 5.39663, 1.50674, 5.7658, 5.00729, 3.58606, 6.08599, 0.89269, 0.0616539, 4.42972],
# [5.9552, 5.94677, 6.13145, 3.29746, 4.51515, 4.42781, 3.61747, 0.699611, 5.84577, 5.59893, 5.2887, 4.99425, 0.433062, 5.62276, 5.67315, 4.64217],
# [0.988461, 5.39039, 6.16887, 5.48345, 5.71997, 4.32056, 4.02405, 5.35141, 5.84706, 4.34857, 3.81174, 6.26561, 0.0500681, 5.87432, 5.48005, 6.11025],
# [5.89055, 0.332953, 1.22527, 5.19392, 5.32002, 3.81554, 3.72224, 2.29077, 3.29386, 3.39144, 1.14945, 0.768486, 1.23922, 4.14191, 4.3691, 4.3662],
# [5.58977, 0.667782, 4.91128, 4.54537, 5.40267, 5.96994, 4.57106, 2.54523, 3.68656, 3.52486, 3.97069, 0.10825, 4.74073, 4.61115, 5.97136, 5.78125],
# [6.22682, 3.18784, 2.83721, 4.07314, 4.02275, 4.96763, 3.35416, 3.17807, 4.91127, 5.79761, 4.83729, 4.86886, 0.92165, 0.806182, 6.1578, 6.27521],
# [4.88551, 4.33837, 4.78944, 4.86515, 4.76499, 0.305752, 6.02202, 2.21175, 0.856747, 0.260512, 6.0007, 5.21083, 5.97214, 0.248968, 0.93234, 4.49914],
# [4.91704, 2.7457, 3.88508, 3.28737, 5.4354, 0.383284, 0.971315, 0.345699, 5.8783, 5.83013, 0.579719, 0.352204, 5.46028, 5.86582, 5.64347, 4.81604],
# [1.31111, 0.601321, 1.30698, 1.30445, 1.60515, 4.41928, 3.01587, 2.50846, 4.05687, 6.20604, 0.231575, 0.369979, 1.14751, 0.364009, 5.42343, 2.93129],
# [1.3452, 1.19482, 3.63064, 4.85205, 1.46643, 3.95208, 3.92603, 3.64892, 5.89122, 4.28529, 4.5506, 0.434243, 1.36935, 5.32175, 0.33035, 2.45456],
# [1.75464, 3.26556, 3.33628, 1.81958, 1.32234, 1.12217, 3.65965, 3.39799, 3.9827, 3.85124, 5.43218, 6.12624, 0.141438, 1.51835, 2.66351, 2.54789]])

L = 25

def another_constrain(x):
    if x < -math.pi:
        return x + 2 * math.pi
    if x > math.pi:
        return x - 2 * math.pi
    return x

vortices = []
antivortices = []
# Compute the vorticity here too so we can plot...
for x in xrange(len(spins)):
    for y in xrange(len(spins[x])):
        delta = 0
        # Now we want to consider the vorticity of the point (i, j)
        # We can do so by considering differing perimeters...
        perimeter = [(x, y), (x + 1, y), (x + 2, y), (x + 3, y),
                     (x + 3, y - 1), (x + 3, y - 2), (x + 3, y - 3),
                     (x + 2, y - 3), (x + 1, y - 3), (x, y - 3),
                     (x, y - 2), (x, y - 1), (x, y)];

        # perimeter = [(x, y), (x + 1, y), (x + 1, y - 1), (x, y - 1), (x, y)]
        
        # Since python is bae, this shoiuld work
        old = spins[perimeter[0][0] % L, perimeter[0][1] % L]
        for idx in perimeter[1:]:
            new = spins[idx[0] % L, idx[1] % L]
            delta += another_constrain(new - old)
            old = new
        if 2 * 3.14 - 0.05 < delta < 2 * 3.14 + 0.05:
            print "vortex at", (x + 1.5, y - 1.5)
            vortices.append(((x + 0-.5) % L, (y - 0.5) % L))
        if -2 * 3.14 - 0.05 < delta < -2 * 3.14 + 0.05:
            antivortices.append(((x + 0.5) % L, (y - 0.5) % L))

print len(vortices), len(antivortices)
x_spins = np.cos(spins)
y_spins = np.sin(spins)
X, Y = np.mgrid[0:L, 0:L]

plt.quiver(X, Y, x_spins, y_spins, spins, pivot='mid',cmap=plt.cm.hsv, clim=[0, 2* 3.15])
plt.axis('equal')
plt.plot(*zip(*vortices), linestyle='None', marker='o', color='b', markersize=4)
plt.plot(*zip(*antivortices), linestyle='None', marker='o', color='r', markersize=4)
cbar = plt.colorbar(ticks=[0, 2 * 3.14])
cbar.ax.set_yticklabels(["0", "pi", "2pi"])

plt.show()
