#!/usr/bin/env python

import matplotlib.pyplot as plt
import numpy as np
import math

spins = np.array([[3.86846, 4.50819, 4.30683, 4.50462, 4.72605, 4.45895, 5.11926, 4.42639, 5.49038, 4.44444, 5.84027, 4.50908, 3.16386, 4.66487, 3.46857, 4.88526, 3.75943, 5.1798, 4.00188, 5.53464, 4.21022, 5.73092, 4.35193, 3.39666, 4.45912],
[3.45441, 4.12193, 3.91378, 4.10522, 4.32804, 4.06124, 4.72813, 4.03213, 5.1268, 4.0467, 2.33463, 4.12456, 2.72472, 4.27615, 3.06737, 4.51497, 3.35079, 4.82004, 3.59747, 5.18155, 3.81264, 2.47505, 3.96175, 2.96404, 4.06849],
[3.89307, 4.53338, 4.33177, 4.51303, 4.73972, 4.47677, 5.13848, 4.4482, 5.5125, 4.46006, 5.85243, 4.53675, 3.18773, 4.69613, 3.48865, 4.93571, 3.77533, 5.19306, 4.02177, 5.55414, 4.23052, 5.82248, 4.38829, 3.42566, 4.4793],
[3.89866, 4.53526, 4.35026, 4.53577, 4.76674, 4.49602, 5.17276, 4.46572, 5.55604, 4.47203, 5.93524, 4.54978, 3.14346, 4.7127, 3.49674, 4.94812, 3.78581, 5.22959, 4.03174, 5.60661, 4.24145, 6.00501, 4.38631, 3.42107, 4.49289],
[3.85797, 4.49478, 4.31018, 4.49188, 4.72254, 4.44925, 5.10794, 4.41524, 5.48141, 4.43206, 5.82891, 4.51176, 3.15495, 4.67879, 3.46503, 4.88736, 3.74826, 5.18569, 3.99896, 5.55765, 4.2015, 5.65513, 4.34087, 3.3919, 4.45062],
[4.30502, 4.94843, 4.74929, 4.9366, 5.18031, 4.89721, 5.57065, 4.8643, 5.9481, 4.87367, 0.0538904, 4.95515, 0.436176, 5.11757, 3.88253, 5.34349, 4.18358, 5.64825, 4.4325, 6.0159, 4.64755, 0.166096, 4.79865, 4.96425, 4.89438],
[3.81981, 4.45111, 4.26177, 4.44529, 4.6795, 4.40352, 5.06259, 4.37072, 5.43739, 4.39118, 5.75879, 4.4635, 3.10161, 4.62732, 3.42099, 4.85222, 3.7111, 5.12718, 3.95905, 5.47667, 4.15441, 4.30986, 4.30386, 3.34135, 4.40476],
[4.72336, 5.32238, 5.1444, 5.31016, 5.56089, 5.26776, 5.94396, 5.23608, 0.0432909, 5.24521, 0.430302, 5.33229, 0.803126, 5.49661, 1.15653, 5.72619, 4.22004, 6.0044, 4.80258, 0.101147, 5.01542, 0.545163, 5.16389, 1.03045, 5.27109],
[3.80899, 4.44092, 4.25598, 4.43587, 4.66577, 4.39216, 5.0433, 4.35845, 5.41784, 4.37698, 5.72655, 4.45509, 3.08647, 4.61286, 3.40298, 4.83724, 3.6919, 5.12797, 3.94082, 5.49122, 4.14381, 3.75671, 4.291, 3.33209, 4.3933],
[1.91923, 5.69749, 5.53997, 5.6863, 5.9403, 5.63908, 0.0480564, 5.60203, 0.43013, 5.62107, 0.81974, 5.70749, 1.19689, 5.86211, 1.53521, 6.10073, 1.84432, 0.125337, 2.10497, 0.497007, 5.31911, 0.933393, 5.53197, 1.42747, 5.64694],
[3.85059, 4.47771, 4.29652, 4.48195, 4.71037, 4.44734, 5.08966, 4.41011, 5.47801, 4.43287, 5.82695, 4.48951, 3.15399, 4.67047, 3.45358, 4.87602, 3.73535, 5.18237, 3.98575, 5.52131, 4.1769, 5.61933, 4.34178, 3.39288, 4.4465],
[2.29654, 3.9508, 2.75907, 3.54861, 0.0581441, 3.06543, 0.438257, 2.97115, 0.814456, 3.01084, 1.20394, 5.43119, 1.57664, 6.24797, 1.91072, 0.208753, 2.20654, 0.498001, 2.44789, 0.878818, 2.68079, 1.32066, 2.86431, 1.82054, 3.07442],
[3.96358, 4.59992, 4.41066, 4.59056, 4.82907, 4.5448, 5.23109, 4.52411, 5.58986, 4.52824, 5.96967, 4.61674, 3.29618, 4.79564, 3.57171, 5.00931, 3.85181, 5.33671, 4.10041, 5.68251, 4.30313, 6.03886, 4.46394, 3.50314, 4.55127],
[2.66454, 3.33621, 3.11984, 3.32462, 3.51725, 3.27732, 0.798868, 3.25217, 1.17456, 3.25981, 1.56066, 3.35164, 1.94074, 3.49555, 2.27424, 0.482052, 2.56414, 0.857817, 2.81644, 1.234, 3.03103, 1.68395, 3.17941, 2.17737, 3.28178],
[4.18613, 4.80047, 4.61235, 4.79215, 5.03917, 4.73862, 5.42224, 4.7174, 5.76842, 4.75202, 6.17331, 4.83055, 0.240064, 4.98217, 3.76512, 5.20909, 4.04869, 5.48242, 4.29255, 5.84789, 4.51131, 0.000632182, 4.6586, 3.75041, 4.74491],
[2.98209, 3.64282, 3.43986, 3.63125, 3.84401, 3.59343, 4.19915, 3.55567, 1.50244, 3.56896, 1.88652, 3.64714, 2.25009, 3.81967, 2.58549, 4.03125, 2.88741, 1.25936, 3.12368, 1.57066, 3.33668, 2.005, 3.49092, 2.49732, 3.58636],
[4.43326, 5.05118, 4.87559, 5.03981, 5.28412, 5.01126, 5.68754, 4.97082, 6.07122, 5.0112, 0.179203, 5.06944, 0.505568, 5.23526, 0.845868, 5.47568, 4.3042, 5.74891, 4.55755, 6.13191, 4.74303, 0.268363, 4.90932, 0.655043, 4.99992],
[3.25122, 3.89209, 3.6971, 3.89825, 4.11582, 3.85387, 4.51533, 3.81792, 1.86222, 3.83819, 2.16378, 3.9144, 2.51855, 4.07602, 2.84298, 4.29839, 3.15142, 4.57837, 3.3929, 1.88668, 3.59586, 2.27753, 3.75847, 2.76567, 3.84441],
[4.85677, 5.37394, 5.19482, 5.36231, 5.60951, 5.3239, 6.00958, 5.29975, 0.108253, 5.30681, 0.509712, 5.41466, 0.8689, 5.56416, 1.21592, 5.76894, 1.61459, 6.09051, 4.85201, 0.172306, 5.07391, 0.589134, 5.21835, 1.07272, 5.32332],
[3.48881, 4.13786, 3.93881, 4.12136, 4.35139, 4.08263, 4.73288, 4.05283, 5.09793, 4.0634, 2.40511, 4.13977, 2.76079, 4.31196, 3.09085, 4.52459, 3.38368, 4.80668, 3.6305, 5.11653, 3.84033, 2.52825, 3.98082, 2.99743, 4.08639],
[2.00048, 5.75142, 5.61175, 5.74947, 6.01444, 5.71216, 0.123802, 5.67104, 0.506319, 5.70972, 0.893756, 5.78804, 1.27435, 5.92595, 1.61609, 6.18609, 1.9217, 0.193771, 2.19709, 0.589815, 3.3098, 1.00903, 5.57188, 1.50956, 5.69603],
[3.66045, 4.30699, 4.11336, 4.28613, 4.53434, 4.26069, 4.91816, 4.22883, 5.28737, 4.23722, 2.79869, 4.31492, 2.94075, 4.47905, 3.27421, 4.69815, 3.54813, 4.98525, 3.80301, 5.34016, 4.01023, 2.75267, 4.15372, 3.18299, 4.26153],
[2.48491, 3.218, 2.93982, 3.21145, 0.100865, 3.14856, 0.59107, 3.10104, 0.980196, 3.13027, 1.37341, 3.2333, 1.75122, 5.1193, 2.08887, 0.333184, 2.38064, 0.662399, 2.6384, 1.04445, 2.86035, 1.48808, 3.02885, 1.98896, 3.15093],
[3.78268, 4.43086, 4.231, 4.42249, 4.65455, 4.37973, 5.03771, 4.35297, 5.4085, 4.36124, 5.71739, 4.44728, 3.07525, 4.5851, 3.40337, 4.83221, 3.67992, 5.10823, 3.91894, 5.45805, 4.12743, 3.25669, 4.28251, 3.32067, 4.37299],
[2.98608, 3.65093, 3.44136, 3.64217, 3.87287, 3.60411, 4.35406, 3.56386, 1.47281, 3.59197, 1.87847, 3.65655, 2.24143, 3.81713, 2.58695, 4.06653, 2.88402, 0.714027, 3.12488, 1.54, 3.35097, 1.99125, 3.50066, 2.4901, 3.6017]])

spins = np.array([[3.54203, 3.35067, 3.02333, 3.01877, 3.16674, 3.13273, 2.90348, 3.31527, 3.21892, 3.29172, 3.34873, 3.40978, 3.06901, 3.13003, 3.16601, 3.49985],
[3.43179, 3.27053, 3.14769, 3.28132, 3.14232, 3.15963, 3.10716, 3.15351, 2.91044, 2.99196, 3.21574, 2.73471, 3.10081, 3.10492, 3.23417, 3.51162],
[3.04603, 2.97076, 3.04187, 3.01703, 3.36701, 3.11826, 3.23622, 3.32476, 2.9813, 3.0968, 2.99401, 2.85662, 2.96115, 2.87999, 3.15752, 3.03395],
[2.92195, 3.04066, 3.1032, 3.19154, 3.22468, 3.16358, 3.00037, 2.9748, 2.65899, 2.91821, 3.20327, 3.20814, 3.0985, 3.08032, 2.91996, 2.7755],
[2.93418, 3.11973, 3.11587, 2.97111, 3.11522, 3.25278, 3.26089, 3.0576, 2.81881, 2.87565, 3.16117, 3.21327, 3.30672, 3.21083, 3.2369, 2.93651],
[2.93704, 2.82982, 3.18409, 2.70519, 2.82625, 2.91436, 3.02587, 3.14654, 2.73985, 2.93098, 3.07662, 3.16748, 3.44212, 3.18633, 2.7887, 2.85922],
[2.58343, 2.96442, 3.01083, 2.77071, 2.98097, 3.01886, 3.26759, 3.17032, 3.02515, 3.2788, 3.4223, 3.13477, 3.29603, 3.12258, 2.96224, 2.7639],
[2.6934, 2.90597, 2.60312, 2.7818, 2.90611, 3.25677, 2.98571, 3.347, 3.31013, 3.44213, 3.51545, 3.33572, 3.4178, 3.06299, 2.78614, 2.88776],
[2.591, 2.71575, 3.00274, 2.71067, 2.64764, 3.29513, 3.52055, 3.41161, 3.34951, 3.16616, 3.53395, 3.37711, 3.16205, 2.91624, 2.80571, 2.79022],
[2.78965, 2.72141, 2.82973, 3.216, 2.95155, 3.66745, 3.60694, 3.52802, 3.49783, 3.59716, 3.51962, 3.50818, 3.15575, 3.1012, 2.93587, 3.13685],
[2.91403, 3.02165, 3.00291, 2.94249, 3.0902, 3.43762, 3.22569, 3.25035, 3.3663, 3.33416, 3.4825, 3.41484, 3.43735, 3.32301, 3.06408, 2.9676],
[3.01572, 3.08621, 2.83941, 2.72794, 2.83617, 3.01922, 3.20193, 3.56837, 3.55892, 3.22378, 3.44974, 3.30098, 3.71715, 3.24458, 3.13644, 3.41747],
[3.14848, 2.8721, 3.16311, 2.90648, 3.1455, 2.99997, 3.11057, 3.41916, 3.65503, 3.45742, 3.55415, 3.51435, 3.49538, 3.32655, 3.28375, 3.19767],
[3.20604, 3.18632, 3.38527, 3.30724, 3.27234, 2.91237, 2.91833, 3.54073, 3.46066, 3.50846, 3.59026, 3.38424, 3.48391, 3.1918, 3.11168, 3.32288],
[3.19169, 3.2087, 3.23216, 3.17668, 2.86514, 2.96858, 3.41487, 3.43717, 3.26949, 3.27244, 3.22223, 3.12387, 3.38065, 3.20024, 3.01098, 3.07368],
[3.19475, 3.41289, 2.91984, 3.15166, 3.18856, 3.2329, 3.41987, 3.58569, 3.67303, 3.10021, 3.13143, 3.06363, 2.87592, 3.17449, 2.8976, 2.9855]]
)

spins = np.array([[3.81641, 4.33135, 3.69056, 3.47056, 4.9789, 4.65589, 4.46258, 4.24612, 4.38951, 4.05202, 4.79228, 5.96947, 5.44433, 4.68921, 4.47063, 4.53344],
[4.0201, 3.88733, 4.11418, 4.08023, 6.10182, 4.4324, 3.73766, 3.35415, 3.51015, 3.4624, 3.04987, 4.35315, 5.25423, 4.97292, 4.96486, 4.7546],
[5.29766, 4.2986, 2.80366, 4.62893, 4.37795, 3.78674, 3.15825, 3.18596, 4.09853, 3.85532, 5.16454, 4.45676, 4.87785, 4.234, 5.74553, 5.35707],
[4.18301, 3.55024, 2.77509, 3.6707, 3.83825, 3.55337, 3.81368, 4.90069, 3.66869, 3.39154, 5.09481, 3.96377, 4.69866, 3.97965, 4.03423, 4.67968],
[4.2412, 3.7651, 2.44428, 3.21729, 3.04526, 3.16968, 2.17453, 3.04289, 2.83269, 3.44388, 4.88567, 6.00776, 4.49721, 5.18045, 4.56461, 4.00388],
[5.53459, 3.488, 3.07914, 3.50969, 3.17865, 3.01169, 3.61098, 3.97058, 2.53456, 3.27707, 3.80513, 4.45663, 3.69202, 3.42874, 3.88919, 4.72733],
[3.54732, 3.38991, 2.19633, 2.40681, 3.14489, 1.62089, 3.84087, 2.6209, 2.99403, 3.71166, 4.08979, 3.3898, 3.71467, 3.0703, 3.25276, 3.10963],
[2.01418, 2.23099, 2.42488, 3.08643, 2.92563, 3.01549, 2.72349, 3.5029, 3.07486, 4.03575, 3.43821, 4.27643, 1.50944, 3.89044, 3.89741, 2.21392],
[3.34321, 4.23534, 2.63595, 3.04949, 4.11051, 2.81765, 2.5243, 3.31818, 3.33556, 3.86714, 3.5379, 4.58007, 4.93867, 4.76248, 4.17178, 3.17861],
[3.70386, 3.61619, 4.00796, 3.89663, 4.66766, 1.52089, 2.23155, 3.38607, 3.62044, 4.73855, 4.99751, 5.39461, 4.43867, 4.78485, 4.012, 3.16996],
[4.32151, 3.76799, 4.23971, 2.66014, 0.0982841, 1.39921, 2.12505, 3.44931, 4.08615, 4.95305, 5.79774, 5.41438, 5.34501, 5.06386, 4.86976, 4.49144],
[4.72189, 4.9609, 3.82246, 3.96437, 5.09598, 5.43738, 5.63663, 3.0853, 5.71133, 1.39702, 0.7206, 5.24903, 5.86551, 5.49345, 4.91346, 5.70423],
[3.1949, 4.11249, 4.42268, 3.91708, 4.52938, 5.16888, 4.70908, 5.74517, 4.0903, 5.94227, 5.22397, 4.73855, 5.34788, 5.18226, 5.91319, 5.68413],
[4.98258, 3.94067, 3.96332, 3.13832, 4.03867, 4.84793, 3.88009, 4.01152, 4.36341, 4.88918, 4.8416, 5.33958, 4.96779, 6.17951, 5.25155, 4.82164],
[4.46642, 4.18054, 3.80133, 4.26622, 4.22051, 4.9175, 4.65886, 5.80416, 4.44185, 4.3347, 5.04066, 5.97354, 5.18111, 5.39944, 3.85181, 3.33913],
[4.16373, 4.03519, 4.10342, 4.62427, 5.16638, 4.63063, 4.14981, 5.05451, 4.54126, 4.46081, 5.49929, 5.90928, 5.39638, 4.94043, 3.57108, 4.14515]])

# this is a new test!
spins = np.array([[2.41007, 5.38221, 4.82314, 4.06719, 3.0438, 3.04178, 4.7055, 4.43352, 5.06576, 4.45385, 4.67831, 4.69526, 5.93049, 5.25387, 5.4377, 1.4118],
[1.18144, 5.77859, 5.06388, 4.12213, 3.90356, 4.13887, 2.48123, 3.12185, 3.07051, 4.35982, 3.88249, 0.203479, 0.422839, 1.70797, 2.62543, 1.9109],
[0.305749, 4.27688, 4.40695, 4.48335, 2.03961, 2.76366, 2.28767, 3.37903, 2.79638, 0.520258, 5.65128, 5.73343, 5.72751, 0.217653, 2.92368, 2.22091],
[2.55626, 3.9346, 3.32446, 3.40394, 2.21598, 2.252, 2.05975, 2.97916, 2.78196, 0.013983, 5.83106, 5.64908, 5.63644, 0.55966, 2.57106, 2.01089],
[3.26541, 3.43778, 2.82413, 3.60849, 3.38355, 2.42496, 2.35855, 2.75536, 4.05191, 5.05541, 4.84462, 6.15102, 1.02916, 1.82562, 3.09301, 3.45937],
[2.99578, 2.75338, 3.05754, 3.69014, 3.32335, 2.93344, 4.07419, 3.94562, 5.21927, 0.834527, 5.94965, 5.63672, 0.514136, 0.8836, 3.30138, 3.55954],
[1.78932, 2.10943, 3.88884, 3.73514, 5.01187, 4.98142, 4.0802, 4.4425, 4.97736, 5.67148, 5.28758, 0.0555177, 5.99461, 2.39376, 2.44529, 2.82359],
[1.97243, 2.64579, 3.82414, 3.61058, 3.53011, 3.96762, 3.28075, 3.37387, 4.74754, 5.2527, 4.69635, 4.7287, 5.47681, 1.75351, 3.03258, 2.92949],
[4.13167, 4.05735, 4.71273, 3.88345, 3.23144, 3.13565, 3.55082, 5.0162, 4.6229, 5.48036, 0.705362, 0.734787, 5.84226, 0.871075, 3.05649, 3.9387],
[3.32107, 3.94039, 5.17217, 4.96597, 5.28911, 4.81334, 4.69833, 4.86821, 5.76377, 4.80172, 5.7808, 5.63594, 5.95479, 5.80825, 3.89288, 4.68054],
[3.72762, 3.5871, 4.86514, 5.10453, 4.92223, 5.20838, 4.7521, 5.28645, 0.283872, 5.83721, 0.227639, 5.91977, 5.83051, 5.6141, 4.5288, 4.16226],
[3.50786, 4.3031, 4.19351, 5.3924, 4.85131, 4.13479, 5.13352, 6.13856, 6.27297, 5.96455, 0.0688171, 5.59384, 5.37027, 5.83787, 4.16288, 4.94863],
[5.09285, 0.212673, 5.60328, 5.36309, 4.83178, 5.22599, 5.14982, 4.84584, 5.35332, 6.28254, 4.89515, 4.40294, 4.09315, 4.41139, 4.80703, 4.75138],
[4.7144, 5.53639, 5.553, 5.1296, 6.11802, 4.89789, 4.37079, 5.26749, 5.84539, 4.16863, 5.75239, 5.56835, 4.30384, 5.44208, 5.01561, 5.0449],
[5.33869, 5.01495, 4.87088, 5.07648, 6.02331, 5.23382, 4.0208, 4.69699, 4.31849, 4.6361, 5.05849, 4.08586, 3.64761, 5.8967, 5.97135, 6.20049],
[4.74835, 4.65647, 5.06277, 5.35342, 5.25431, 5.45874, 4.01423, 4.98463, 5.3215, 4.32642, 5.80596, 5.22229, 4.1347, 4.95637, 5.42009, 0.781253]])

# spins = np.array([[1.17311, 5.74787, 3.22849, 2.65695, 3.88579, 4.96931, 5.95979, 1.0067, 2.34376, 0.700519, 3.89143, 0.0431785, 2.76562, 2.29111, 2.79528, 1.23177],
# [0.880307, 4.70172, 1.9068, 2.60228, 3.06908, 0.702853, 1.18485, 0.160693, 0.425963, 3.63182, 3.68032, 0.908404, 0.295884, 5.69629, 1.16037, 0.933844],
# [1.21873, 3.11733, 4.71668, 4.01514, 3.60409, 2.31305, 0.991491, 2.51912, 1.81545, 4.13733, 3.45301, 1.15515, 4.29429, 2.70513, 2.36425, 5.62003],
# [2.90426, 3.41872, 2.69547, 4.66428, 4.34107, 5.6875, 0.228111, 2.51284, 4.10192, 1.30201, 0.181682, 0.615314, 0.24132, 3.78974, 2.04213, 0.945578],
# [3.83604, 3.33936, 2.51114, 4.87445, 4.89831, 2.29162, 3.03742, 4.90048, 3.5489, 3.51656, 5.20527, 6.10855, 0.441698, 3.00777, 2.48531, 2.97785],
# [6.20002, 0.0376199, 2.68611, 5.01612, 4.35526, 1.37427, 3.91484, 3.52352, 0.0770053, 2.63886, 4.35558, 0.319828, 0.864163, 1.93563, 3.01577, 2.77139],
# [0.367926, 5.97467, 5.9402, 1.87099, 2.46784, 4.14176, 4.02027, 3.55981, 5.70843, 5.39949, 3.5847, 0.0893563, 0.604508, 2.7452, 4.90231, 0.861883],
# [6.20671, 1.12828, 1.81699, 1.99927, 2.10214, 3.02264, 1.89136, 2.46257, 0.578355, 0.811003, 3.10148, 2.42882, 3.68134, 4.94359, 3.9784, 6.05554],
# [5.19621, 1.10895, 2.51273, 0.946322, 5.95662, 4.24113, 4.68798, 3.88296, 5.07999, 0.162378, 2.68413, 0.431219, 2.18276, 3.75486, 4.51654, 2.3437],
# [1.64493, 3.06894, 3.37675, 3.98933, 1.86565, 1.3134, 5.42762, 5.29328, 4.95521, 4.20725, 1.57174, 2.80032, 2.07705, 5.82691, 3.45616, 2.27567],
# [1.27398, 2.08632, 2.26263, 3.78691, 3.29391, 4.14175, 4.11855, 3.69222, 5.06639, 3.69206, 0.958691, 3.86956, 4.01106, 2.09346, 4.43655, 1.80729],
# [1.24228, 2.89261, 5.93799, 5.18554, 3.83307, 3.505, 2.90908, 5.62488, 4.86227, 4.57426, 6.09287, 0.803145, 5.32066, 1.4488, 0.95174, 1.24565],
# [5.06061, 0.949942, 1.43131, 1.08662, 2.36099, 1.43729, 2.52395, 4.12149, 5.72513, 0.524819, 2.83459, 6.22138, 5.46252, 5.50071, 5.24075, 5.74642],
# [0.0097626, 1.03053, 1.71303, 0.985934, 1.5375, 2.46799, 4.64131, 3.75234, 2.53667, 0.987186, 3.1965, 5.92003, 5.5649, 4.92975, 0.628158, 3.7477],
# [0.94858, 6.10339, 0.0986915, 1.76011, 2.38839, 1.73578, 1.59513, 3.29271, 2.52123, 0.0929074, 0.581127, 1.16728, 0.238426, 5.44206, 4.08612, 4.80738],
# [5.32725, 2.61551, 2.71618, 1.94775, 2.41623, 4.00531, 0.417493, 0.497691, 0.69136, 5.99928, 0.536442, 5.97938, 0.462754, 1.31784, 5.36956, 3.63513]])

L = 16

# First, make sure all values in the spin array are between 0 and 2*pi
assert np.all(np.logical_and(spins>=0, spins<=2 * np.pi))

def angle_mod(theta):
    if theta > math.pi:
        return theta - 2 * math.pi
    if theta < -math.pi:
        return theta + 2 * math.pi
    return theta

vortices = []
antivortices = []
# Compute the vorticity here too so we can plot...
for x in xrange(len(spins)):
    for y in xrange(len(spins[x])):
        delta = 0
        # Now we want to consider the vorticity of the point (i, j)
        # We can do so by considering differing perimeters...
        # perimeter = [(x, y), (x + 1, y), (x + 2, y), (x + 3, y),
        #              (x + 3, y - 1), (x + 3, y - 2), (x + 3, y - 3),
        #              (x + 2, y - 3), (x + 1, y - 3), (x, y - 3),
        #              (x, y - 2), (x, y - 1), (x, y)];

        perimeter = [(x, y), (x + 1, y), (x + 1, y - 1), (x, y - 1), (x, y)]
        old = spins[perimeter[0][0] % L, perimeter[0][1] % L]
        for idx in perimeter[1:]:
            new = spins[idx[0] % L, idx[1] % L]
            delta += angle_mod(new - old)
            old = new
        if 2 * 3.14 - 0.005 < delta < 2 * 3.14 + 0.005:
            vortices.append(((x + 0.5) % L, (y - 0.5) % L))
            print (x + 0.5) % L, (y - 0.5) % L
        if -2 * 3.14 - 0.005 < delta < -2 * 3.14 + 0.005:
            antivortices.append(((x + 0.5) % L, (y - 0.5) % L))
            print (x + 0.5) % L, (y - 0.5) % L

print len(vortices), len(antivortices)
x_spins = np.cos(spins)
y_spins = np.sin(spins)
X, Y = np.mgrid[0:L, 0:L]

plt.quiver(X, Y, x_spins, y_spins, spins, pivot='mid',cmap=plt.cm.hsv, clim=[0, 2* 3.15])
plt.axis('equal')
plt.plot(*zip(*vortices), linestyle='None', marker='o', color='b', markersize=4)
plt.plot(*zip(*antivortices), linestyle='None', marker='o', color='r', markersize=4)
cbar = plt.colorbar(ticks=[0, 2 * 3.14])
cbar.ax.set_yticklabels(["0", "pi", "2pi"])

plt.show()
